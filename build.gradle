plugins {
    id "java"
    id "maven-publish"
    id "com.jfrog.artifactory" version "4.3.0"
}

apply from: '/usr/local/cadc/build/_canfar.build.gradle'

version = '1.2'

dependencies {
    compile group: 'log4j', name: 'log4j', version: '1.2.17'
    compile 'org.freemarker:freemarker:2.3.24-incubating'
    compile 'com.opencsv:opencsv:3.+'
    compile files('/usr/local/cadc/lib/wsUtil.jar', '/usr/local/cadc/lib/wsUtil-augment.jar')
    compile group: 'org.restlet.jee', name: 'org.restlet', version: '2.3.+'
    compile group: 'org.restlet.jee', name: 'org.restlet.ext.servlet', version: '2.3.+'
    compile group: 'org.restlet.jee', name: 'org.restlet.ext.freemarker', version: '2.3.+'
    compile group: 'org.restlet.jee', name: 'org.restlet.ext.json', version: '2.3.+'

    compile group: 'canfar.net', name: 'cadcUtil', version: '3.+'
    compile group: 'canfar.net', name: 'cadcLog', version: '3.+'
    compile group: 'canfar.net', name: 'cadcVOSI', version: '3.+'
    compile group: 'canfar.net', name: 'cadcVOS', version: '2.3.+'
    compile group: 'canfar.net', name: 'cadcVOS-Server', version: '2.+'
}

jar {
    doFirst {
        manifest {
            attributes ('Main-Class': 'ca.nrc.cadc.beacon.web.application.VOSpace')

            if (!configurations.runtime.isEmpty()) {
                attributes('Class-Path': configurations.runtime.collect{it.toURI().toString()}.join(' '))
            }
        }
    }
}

publishing {
    publications {
        mavenJava(MavenPublication) {
            from components.java
        }
    }
}
